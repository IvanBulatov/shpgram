import{_ as v}from"./DMY1mA1Z.js";import{u as _,l as f}from"./DAQNoHoj.js";import{_ as x,c as r,a as s,b as g,w as y,Q as m,X as a,Y as d,G as c,N as u,O as b,o as i,d as k,t as p}from"./C-PZcxHO.js";const w={data(){return{messages:[],username:"",connect:!1,socket:null,text:"",receiver:""}},methods:{async loadMessages(){let{data:n}=await _(`/api/messages/${this.username}`,"$PslAyef5YX");this.messages=n,console.log(this.messages)},handleConnect(){this.username.length>0&&(this.loadMessages(),this.connect=!0,this.socket=f("ws://localhost:3000"),this.socket.emit("logged_in",{username:this.username}),this.socket.on("chat message",n=>{this.messages.push({text:n.text,sender:n.username,receiver:n.receiver})}))},sendMessage(){this.socket.emit("chat message",{sender:this.username,text:this.text,receiver:this.receiver})}}},M={class:"container"},N={class:"row"},V={key:0,class:"col-4 form-container"},j={class:"card"},C={class:"card-body"},Y={class:"mb-3"},S={key:1,class:"col-4 form-container"},T={class:"card"},U={class:"card-body"},B={class:"mb-3"},D={class:"col-8 notes-container"},E={class:"card mb-3"},F={class:"card-body"},L={class:"card-title"};function R(n,e,W,X,o,l){const h=v;return i(),r(u,null,[e[8]||(e[8]=s("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css",rel:"stylesheet",integrity:"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH",crossorigin:"anonymous"},null,-1)),e[9]||(e[9]=s("h2",null,"Всем разрабам привет. Я стажёр, но уже положил всю базу данных )) Извините ...",-1)),e[10]||(e[10]=s("h2",null,"Антон, ты уволен...",-1)),g(h,{to:"/test"},{default:y(()=>e[5]||(e[5]=[k("Тестовая")])),_:1}),e[11]||(e[11]=s("div",{class:"container py-3"},[s("h1",null,"Чат")],-1)),s("div",M,[s("div",N,[o.connect?c("",!0):(i(),r("div",V,[s("form",{onSubmit:e[1]||(e[1]=m((...t)=>l.handleConnect&&l.handleConnect(...t),["prevent"]))},[s("div",j,[s("div",C,[s("div",Y,[a(s("input",{type:"text",class:"form-control",placeholder:"Имя пользователя","onUpdate:modelValue":e[0]||(e[0]=t=>o.username=t)},null,512),[[d,o.username]])]),e[6]||(e[6]=s("button",{class:"btn btn-primary"},"Войти в чат",-1))])])],32)])),o.connect?(i(),r("div",S,[s("form",{onSubmit:e[4]||(e[4]=m((...t)=>l.sendMessage&&l.sendMessage(...t),["prevent"]))},[s("div",T,[s("div",U,[s("div",B,[a(s("textarea",{type:"text",class:"form-control",rows:"10","onUpdate:modelValue":e[2]||(e[2]=t=>o.text=t)},null,512),[[d,o.text]]),a(s("input",{type:"text",class:"form-control",placeholder:"Имя пользователя","onUpdate:modelValue":e[3]||(e[3]=t=>o.receiver=t)},null,512),[[d,o.receiver]])]),e[7]||(e[7]=s("button",{class:"btn btn-primary"},"Отправить сообщение",-1))])])],32)])):c("",!0),s("div",D,[o.connect?(i(!0),r(u,{key:0},b(o.messages,t=>(i(),r("div",E,[s("div",F,[s("h3",L,[s("span",null,p(t.sender)+": "+p(t.text),1)])])]))),256)):c("",!0)])])])],64)}const P=x(w,[["render",R]]);export{P as default};
