import{u as p,l as v}from"./epAXZFJO.js";import{_ as g,c as r,a as s,Q as m,X as a,Y as c,G as d,N as u,O as y,o as i,t as h}from"./BxDfOHhC.js";const f={data(){return{messages:[],username:"",connect:!1,socket:null,text:"",receiver:""}},methods:{async loadMessages(){let{data:o}=await p(`/api/messages/${this.username}`,"$PslAyef5YX");this.messages=o,console.log(this.messages)},handleConnect(){this.username.length>0&&(this.loadMessages(),this.connect=!0,this.socket=v("ws://localhost:3000"),this.socket.emit("logged_in",{username:this.username}),this.socket.on("chat message",o=>{this.messages.push({text:o.text,sender:o.username,receiver:o.receiver})}))},sendMessage(){this.socket.emit("chat message",{sender:this.username,text:this.text,receiver:this.receiver})}}},b={class:"container"},x={class:"row"},_={key:0,class:"col-4 form-container"},k={class:"card"},M={class:"card-body"},w={class:"mb-3"},j={key:1,class:"col-4 form-container"},V={class:"card"},Y={class:"card-body"},C={class:"mb-3"},N={class:"col-8 notes-container"},S={class:"card mb-3"},U={class:"card-body"},B={class:"card-title"};function D(o,e,E,F,n,l){return i(),r(u,null,[e[7]||(e[7]=s("link",{href:"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css",rel:"stylesheet",integrity:"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH",crossorigin:"anonymous"},null,-1)),e[8]||(e[8]=s("h2",null,"Всем разрабам привет. Я стажёр, но уже положил всю базу данных )) Извините ...",-1)),e[9]||(e[9]=s("h2",null,"Антон, ты уволен...",-1)),e[10]||(e[10]=s("div",{class:"container py-3"},[s("h1",null,"Чат")],-1)),s("div",b,[s("div",x,[n.connect?d("",!0):(i(),r("div",_,[s("form",{onSubmit:e[1]||(e[1]=m((...t)=>l.handleConnect&&l.handleConnect(...t),["prevent"]))},[s("div",k,[s("div",M,[s("div",w,[a(s("input",{type:"text",class:"form-control",placeholder:"Имя пользователя","onUpdate:modelValue":e[0]||(e[0]=t=>n.username=t)},null,512),[[c,n.username]])]),e[5]||(e[5]=s("button",{class:"btn btn-primary"},"Войти в чат",-1))])])],32)])),n.connect?(i(),r("div",j,[s("form",{onSubmit:e[4]||(e[4]=m((...t)=>l.sendMessage&&l.sendMessage(...t),["prevent"]))},[s("div",V,[s("div",Y,[s("div",C,[a(s("textarea",{type:"text",class:"form-control",rows:"10","onUpdate:modelValue":e[2]||(e[2]=t=>n.text=t)},null,512),[[c,n.text]]),a(s("input",{type:"text",class:"form-control",placeholder:"Имя пользователя","onUpdate:modelValue":e[3]||(e[3]=t=>n.receiver=t)},null,512),[[c,n.receiver]])]),e[6]||(e[6]=s("button",{class:"btn btn-primary"},"Отправить сообщение",-1))])])],32)])):d("",!0),s("div",N,[n.connect?(i(!0),r(u,{key:0},y(n.messages,t=>(i(),r("div",S,[s("div",U,[s("h3",B,[s("span",null,h(t.sender)+": "+h(t.text),1)])])]))),256)):d("",!0)])])])],64)}const W=g(f,[["render",D]]);export{W as default};
